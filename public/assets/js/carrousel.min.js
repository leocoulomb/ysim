/* Author S.Groleau, Canopé, https://www.reseau-canope.fr/ */
!function(w){w.fn.animatethecarousel=function(n){n=w.extend({width:700,height:260},n);var c,t,f,r,e,i,s=w(this),u=s.find("img"),a=u.length-1,l=3e3;function p(){s.find(".legend").remove(),s.find(".controls").remove(),u.hide(),clearTimeout(t)}function h(d,n){t=setTimeout(function(){var n,t,e,i,o;f=x(n=d),u.eq(f).hide(),(c=u.eq(n)).show(),g(),i=c,o=n,s.find(".legend").remove(),i.after('<div class="legend"> </div>'),function(n){for(var t=0;t<=a;t++)t==n?s.find(".legend").append('<button id="active">'+(t+1)+"</button>"):s.find(".legend").append("<button id="+t+">"+(t+1)+"</button>")}(o),v(),s.find("button").not("button#active").click(function(){var n=w(this).attr("id");p(),h(n,0)}),t=c,f=x(e=n),r=b(e),u.eq(f),u.eq(r),s.find(".controls").remove(),t.after('<div class="controls"></div>'),s.find(".controls").append('<span class="prev" title="Item précédent">&lt;</span>'),s.find(".controls").append('<span class="next" title="Item suivant">&gt;</span>'),m(),s.find(".prev").click(function(){p(),h(f,0)}),s.find(".next").click(function(){p(),h(r,0)}),h(r=b(d),l)},n)}function o(){return n.height/n.width*s.outerWidth()}function g(){s.css({height:o()+"px"})}function v(){s.find(".legend").css({top:o()-s.find(".legend").outerHeight()+"px"})}function m(){e=s.find(".controls span").height(),i=(o()-s.find(".legend").outerHeight()-e)/2,s.find(".controls span").css({paddingTop:i+"px",paddingBottom:i+"px"})}function x(n){return--n<0&&(n=a),n}function b(n){return a<++n&&(n=0),n}h(0,0),w(window).resize(function(){g(),v(),m()})}}(jQuery);